#!/bin/bash

. "${0%/*}/completer-testbase.bash"

# ==============================================================================
# Start tests
# ==============================================================================

test_cargo() {
  COMPLETER_IGNORE_CASE=1 assert_comp run_ruby -x $compdir/completer-cargo.rb -c "$@"
}

test_cargo 1 cargo <<'EOF'
'bench '
'build '
'check '
'clean '
'--color '
'doc '
'--explain '
'--frozen '
'-h '
'--help '
'help '
'init '
'install '
'--list '
'--locked '
'new '
'publish '
'-q '
'--quiet '
'run '
'search '
'test '
'update '
'-v '
'-V '
'--verbose '
'--version '
'-vv '
EOF

test_cargo 1 cargo -- <<'EOF'
'--color '
'--explain '
'--frozen '
'--help '
'--list '
'--locked '
'--quiet '
'--verbose '
'--version '
EOF

test_cargo 2 cargo help <<'EOF'
'bench '
'build '
'check '
'clean '
'doc '
'init '
'install '
'new '
'publish '
'run '
'search '
'test '
'update '
EOF

test_cargo 2 cargo clean <<'EOF'
'--color '
'--frozen '
'-h '
'--help '
'--locked '
'--manifest-path '
'-q '
'--quiet '
'--target '
'-v '
'-V '
'--verbose '
'--version '
'-vv '
EOF

test_cargo 3 cargo clean --target <<'EOF'
'i686-unknown-linux-gnu '
EOF

done_testing
